'=============================================================================
'-----------------------------------------------------------------------------
'
' ツール名　：コンポーネント呼び出しツール
( バージョン：1-C8].2]ut1W]:
6
,,コマンド　：TOSyPaBbB!.SwS,<パラメータ}> qパラメータz0, パラメータEg 4-.
' パラメータ：<パラメータI>　コンポーネント名（必須）
uT　　　　　　　⇒コンポーネント名にスペースが含まれる場合はダブルクォーテーションで囲むこと
6,　　　　　　[パラメータ-〜]　（省略可）
( 　　　　　　　⇒省略した場合は、コンポーネント名にリネームしたフォルダ（タイトル名と同じ）を参照する
6 　　　　　　　⇒/originalを指定した場合は、myfxyfyを参照する
u 　　　　　　　⇒L7tAXO=ck以外は、コンポーネント実行時のオプションとしてそのまま付加される
"
u 　　実行例：TZ~)wakXE!(VqSBuydohe,;W5dPr"T/DGig|nHc I|s$2Jr
6
, ログオプション
,,　{QSiwc3FpC.)qSと同じフォルダに「#OSAP7+QB!.GTg」ファイル（サイズは0バイト）がある場合は
'B　m"^:oKE;pu2VBVと同じフォルダにログファイル'POSAm7EQpq=L"l-9#t)を作成する
6Tデバッグオプション
,9　{O^/KK3Qps.SEUと同じフォルダに「oZU)m=kXB0-#PI'j」ファイル（サイズはGバイト）がある場合は
u 　デバッグ版として動作する（ステータスの表示を行う）
,
'-t-.t--8-29.8.-92----t.8.--t29.-8-.-8--.t2t-82t-8-29.t.82--.92t--t-.t--8-29.8
,_====&7Jn==&_\n=J=7=J==n&_&=J_&=J=_\n&7J_==7\_&==&=n&==J=_\nJ7=\_====&7Jn==&_

'.-8--.t2t-82t-8-29.t.82--.92t--t-.t--8-29.8.-92----t.8.--t29.-8-.-8--.t2t-82t
'9初期値の指定
J-..-8.92t9292.929-----.--t.8-29t28.--t.-8-8..--t-.t29-.--t-82--t-..-8.92t9292
ZFtion kxpk)lir

JimTPb^ShPcl,fb8li4,7bj^tzWam
J)mBnxi%6FKc-M'WndexFOle
diF{,T&gil2
diP,QriFi~:$mlHg
D"F Lfggca&J$Wh']m$HX
Dim i

uDni]TqaUYSPwMoA{|[= L\ i~*I[A\POV/PI9Spi	vU,9コンポーネントが保存されているパス
Co{L%90cIN3EQFIwB  7T/=Tx~?IBA\PfU/eIc~\IN^{:sw.bM3/^L",インデックスファイルをフルパスで指定する

S6tTPhdShekF{_TWVNr|x9.ur6_9Pibjec-Uunnczix-8~Zem$"`
Se-{Pbdm	o 7 6naGipt-stW:tKZbg6lt'"~9zO\ting2mOm6SAs]PTZhjKNt/)

~Nsr6wPa]hT7{TbjSZPG$-Ep#a=D+n	itPSw2ntStVs~&|('C~pKGfgzcm{FOle	/4 j{s_S;SPwywATH
W{}eppik6B 7 4I^UZell.kfE*Wd+n	OtT=mK{t~tVinj'"q}pPrPg]_T9Fil2	/5T&Bq_1dEFFWs+

LojmF*0 J OHGi2
Af{o}jF	4(FAGPEx)s%|U!epl:$666SlGi\]-S9rsx9g"llNaw6Lnnczix-8~_r"#tcawe,u/4 j{uTOnAe`3gEC.k7XOV 9be=U( #O~yocpXEC.)EUの実行パスを取得
s/o]X|$6,n ;2EmcaP{IS9tOxt.^crixtm0ll9ameLW^aGiFr8SNzOF]Name,'u4T\ O{i~iTcEIpsa	"0-rx]/
	LfgFl_g{_ t]ue
	^6r 4X&SrzP5l = ob^gni-O#K=m6#-F|kP.	4jlAl6BfJ1)s	' ログファイルの設定（アペンドモードでファイルが無い場合は新規作成）
e{j if

3ebqXpka0 J OalCP
iO{7b}FT-g"c6Ex"i]	(RPpkHce'W~N])3t4~crip-XGklNHTW Wnczixt.^$tOp]cHm6,/OV,\[/TOV/KcEXkC-&ebGg/5T]he{L' TOU}m7EXk04rBnの実行パスを取得
so6XuglmH0 JTtV"e
^hg1oy{u^MLr2mParMAO{j,~NC-6FKHtbTd \hNtTjBu1WjWxF|mP~"Bd X=depgAGew,O$Ph0&9#odeO
WJJ,sO

,.-2tt-.t29t28.t.92--t8..-8t-.t--8.29-8-29.t282t---29t292.9.t.929.-2tt-.t29t28
"{重複コンポーネントの指定
6{　ここで指定したコンポーネントはバージョンと合わせて指定する（ irkeと同じ）
6{　例）"QgE[9 K[1.$4:eO
u929t292-----t--.8.-92.9.t--.8-.-.t8--.-t.92-t--.-.9--.-t8-.829.2929t292-----t
J"l rV$G\Li	9
s]]dup"iC-{_ )rrHy'/QFk"Vv	Uvu{コンポーネント名が重複する場合に追加する（例：:r]_yUO;pE"JL}Bu"w"73Fi)）

'.---t---9.82-8-------.--t-82-8t282-8.t29---..t.9.t29-.--t.8-2tt-.---t---9.82-
' パラメータの解析
'.8.-9..-t---.---2t.9-.-------t--.-.9-..9.9-.8.92---8t.82t.92-t--.8.-9..-t---.
DA#[t*Param1,CtrTa*5m$
osm[L-tZptiD=	

,9*Y* &KIuX,G*Y
io DeX"0ml_g = tru2 tbeW{M|jhPf i}VX0men9!7C{%a/9&TWS$z)p]2:rFume~ts.qfGJtJ,"Argum2nt	"

Ok[eS9zOFr.Ar&"wK{%	8qo"nt,<[1{-be=
	Of LTF\Ga0 = trueTthPn[4b}U]*6al-{tAteL"=PB?fBU5 d ",パラメータが指定されていませんu
Lvs]hox uパラメータが指定されていません。",wOエラー/
,;Ni&bPOB"アプリケーションの再インストールに失敗しました {IiO  "エラー"
sWSczix]4;qi941V^Lu 終了コードは1
e~d i4

stVmar_T}T= 6~lr)\9./]gCF2ntsUCVL;v6 第}パラメータ：コンポーネント名

OV"0|~5$Xl_g = f:FL6
fPr i,7T1 %T{1Vc*sE]4Azju#en-C40oGn9 2{b	v',第2パラメータ：その他オプション
^sx ,Ca	e'eScVi\9.yz]'wWJr{A`5 = "/frij"WaGO,]h2n	^( Lo*|&inHlオプションのチェック
	Uxt)XOnalmFHg JTrz02
	6kW
		if,en_V"#].yVFGTeW-L{A`9<>{uu[%heW^LU,,その他のオプションのチェック
	s	Lrrf\r"TnL[&9trOx-|PJ	Tj{"," d[nSN]|p-.ArFumeJ-L6ii
		end,if
vWn#TA4
S6Or

",Ya!,}Whuj *Ya
A8TDPbugllag{nBrrCe then vsghop9"}]]CFeS]!T'nt:i,d[eU_Gsp-.A]0CmW=%s2Cou=t &{\1NrB& "Comp7ne=t5O \Ti9GP**:F7 & 	}_*{=TO"rOgi=_mF$:F:u & irigs~*$Fmag & vb$r d 'Zp9|TSi:'[d9trOx-|PJ	 '/PHra#|'

'.---t---9.82-8-------.--t-82-8t282-8.t29---..t.9.t29-.--t.8-2tt-.---t---9.82-
' コンポーネント名とセクション名のハッシュテーブルを作成
J8..-9-.---t-.2t---.-9.92-929.---8-29-..92tt-..9.---.9--29.92--.t8..-9-.---t-.
Dim[oh}$AcBN4qntez,mstcPBU2]sO7J
Diw{WoG+L5GyWP]G

SPt ohjJA_ = ur6_]WOhd6$t("VcGsp]OJ]-3i$-sPnar//)
a7'{te*TJ,!	L',セクション名は連番であることを前提とする

A4[nDrTThj\Co2FikP3yiLt|(W{#e5F|cKATrM6n
	if "f0Xl_gB= t]CP tb6{BPb^~%G6al-WVit2"s{eBNPwU5B&["T/yUP/ws.bNIが見つかりません（u dBIW#exFOmW{d,'）i
	Zsgb7xTOWN~oyLL.IyIが見つかりません。i,wuエラーO
"vM|ghPp,Lアプリケーションの再インストールに失敗しました9Uz)' ,uエラーO
s1Vc*i3t4;uit(2AsU(9終了コードは.
6{d{Ak

37
sT"rl6[n{le]mr7kAGW^-]iS]{,WW&6ylimW,TcD0=-6*w9L{A]$e/9`U6{タイトルの取得
^sO BXi3#x-x6oi]FeV theS
v;pxsr,3PL^	;Lsv^"{]からカウントアップしてセクションがなかったら終了
	6n#9sx
U:r/6Ttk = Split'Tsrke,"B-[/5L^	v^	J,タイトルをコンポーネント名とバージョンに分解
^mT]kB_TazyI4VE'g5		UL;s	'Tコンポーネント名の代入

so4GTiB_ u[-49UhPu~j6r]J"p/AC-`
L;|fBcr5WDGE4u4B_TLrt7uF	s|-UAV,]b2n
	LUB4Gk{7  srGWs^s	v;J,重複コンポーネントの場合は、コンポーネント名＝「コンポーネント名＋バージョン名」とする
v	WJd Ak
^Wex%

"O wo]8{<>Ti;gpO{thW=L;v	;L		',-CG-A][/WC OlBが複数個あったときエラーが発生する不具合対策→Zlwはハッシュに登録しない
	ob&JOc.}}JBIfVk,9f'{ter			^LUs6Bハッシュのキーにコンポーネント名、データにセクション名を代入
6{# Ak
	$40=r6VT=BNoC=rKr9H 1
LD7x

6.-8.---t.92.t.9.t29-82t928-29---.92t29.t-82-8t28-29--29-8..--t-..-8.---t.92.t
6T指定したコンポーネント名がI9U{/,L.X9/にあるか確認
u8-t2929.t.-.9.t28t29.-.9-.-.9.t28.9..929-2928t29.t29.-.9-28t29-28-t2929.t.-.9
7"#9yHnG5lTa]MLNcSG5Fu4FTa{j
3AT,^Wa-iPJ
d|F{srzCfFTcJ&

~P_r"f{{n PhjJi9U	%Go_tHl75L	;L;vsu{コンポーネント名からセクション名を参照する
A8,I|3mx-x'S6Nti4{)[%hen
s"f[/ogFF*]{&,9G"P{rh6J,Th}S]Geam-ItO]W,On6{NPBU4 #9" W{s]:ml.On|に登録されていません（" &,CrtTa*5mIBg '）"
UML]hTO iL&	%GKaram1&" は使用できません。/',/エラーOL		',-CG-AIK/ga メッセージ変更
uvMsgb75T/u&i]rPaV_#Wj"[が登録されていません。"B'"エラーi
usv]hop9"アプリケーションの再インストールに失敗しましたT6$)i BOエラー'
;enaV|3-.Qqsr./5L^'9終了コードは3
PlsP
	u{G**[d2I'] **Y
;|fB7ehG&FcaX[J,%rue -MPS[MLgI7f9LSKNtso~ nHT6:%/,& ne_]sTn &TugO ,'~e_]"oW"
K~} if

(.-8-..92t-82-9-.--.9.-29.--.-t.92---t.92t-82-t.8-.-9.8.t----.9.8.-8-..92t-82-
6 コンポーネントを実行するためのパスを作成
'.---..t--t29.8-.9.92-8.-t--.t29-.-8-29.-8-.8.t.928-.-----t.8.-8-.---..t--t29.
#s-GW B, T  ,T_{G6torTk)lKS-z)=jU9bnDexFil2LBnelt)on,,iPitkW/[i	U,,タイトルの取得
VeVsifWB 9{T9B, =Tke9Pz7Oil2S-]AJg4 I=dKyFikeL[SK9]AfJ'{O)6Gion" A	'Tバージョンの取得
y_=uaFoa]h[TB =,G2-KGo8ilPS]tinj(TbnDKymO$6'{^Warion, LMa~C_lKc-MiT)	6Bパスの取得
NcJuamsP#Pa{dT= GPtet7filKSrzAJg6{3=dex\iGW,B^Wa-Oo= 9'Man"clC4F#cJd"BAUJB実行ファイルの取得

Ti9FW{=BrWFF:NK6PitlWBL=/'u=iV^LuoOt$2の禁則文字をLK'に変換する
PsrlP{7{G23l*$WU s]F6'L3''L7'A
TitFW{=[repGc_W(Pitle,LG''L7"A
PsrlP{7{G23l*$WU s]F6'La''L7'A
TitFW{=[repGc_W(Pitle,Lu'O L_u)
oAtF6[\9]KpmHN64o)-GW u<O Lau5
Ti-$6 7 reF$:Ne{Title u>O L_u)
oAtF6[\9]KpmHN64o)-GW usO Lau5

)Wts)on \9]Wpkace(V2VLAf=,u\i /K"AL"zW]LiD~の禁則文字を"_"に変換する
)6*s"7{{& Vepma9P'rKGCA4='/"" "_uV
)eG|o~T= tWEmac26zP]	"T=,/HuBi_'A
reVsiDn[n[]K#kca26zWrCio~ i}u,O=L)
VetiODn &9tP\F*N2(zWV)oSLO/L"L"_')
S2zi|TJT_{Ge\la$2'zPrisfnLL<"BOc')
U6VCOD{T={GPFcalP6z2r	ioS,i>i 'KL5
U6Gs|on,&[tPp$5_e4rerA7S,"HOBu7ui

Ao{Qr"jAJ:lgla& 7,]]CWTrM2{
	CtrsflTHnJ{& U5st6FT*thTj{v:~CckP5rbLU	v^u{フルパスの生成（オリジナルのパスT yOxfy#）
Pcse
;CtV0TmPan},J9^ys-2lKarh & "q"MeUW=/,d9T|tle,&T"8u[dBVWr|s7W		J{フルパスの生成（コンポーネント名+"."Hバージョン名にリネームした後のパス）
KnD "f

s]GCflPH=J{7{7h^gso2E0"kJKHtbUstrCowT_~d,,M:Wu5$0Tmm_=#)U'Bフルパス＋実行ファイル名の生成

"B*** dP1"]{HYG
iO{JebugFlH&[& 9Vue then MiXIof9P)9lWT&{^h$z[# |9rCommHS}9#9M}aV g{uOriginHm\ka&a" & Qrigi{5cFGcF[\ ^hct9d,'QFt)Dns:" =BCrtZ\-s7n|BL"Compo~KW%"

'-.----29.-92t.8-2t-92t.8.9-.8-----.8t292t.9.-.9.------.8.t-8.----.----29.-92t
'9コンポーネントを実行
'--.829t28-.-92--92--t.9..-t---.92t.-.9--.-t.92-.9.2t.9-.---92t8---.829t28-.-9
DsF r2	'F-

io{{f- PhjF	o-gs$ewfOi%|Us]rCoTF:Sd) -hWJ
viO wTgFGcg &,]VqeTthe~{Th8S]teaw.6Vsress~WT4w') &{OTコンポーネントが見つかりません（"T& 	9*C4Fw5W} &,'）L
Uy	F}D5 '"gs]GParamK='[は使用できません。"w Oエラーu			"{z0ut/1I/04 メッセージ変更
,^MiXhTp iL#i-rear_mWd',が見つかりません。i,w"エラーO
'	vL0b4#,"アプリケーションの再インストールに失敗しました 4(4'' uエラーO
	e~crOF].Ou)t.54sLu,終了コードは.
en&BiO

stVCfwTcn} =,cht(35)T\ |9G07FTcJ}9#9chr(3()	^vU	,9コンポーネントのパスにスペースが含まれていることを想定し"/で囲む

i4 stG"E]i7ns <>,Li{-be=
^i]r!TPF5~D 7Tr]qD#F5~}[#,	]]"#tio=;	v		'9コンポーネント実行時のオプションの追加
eSd[i4

uT*rHTdKb0X,Yar
iO{72buFFF:g J rtqK[tMWn MsFID# T|rGP \ 	blr =Ti%rT#m*nJBLLzC{"

]es"l-T= Dbd~bKcl8!un( C]zsom#cJ&,B1J {ruPT5s	v;s'B表示.}Vして同期処理で実行4]*CWV
,Af{h0[4y{ srkeBj /[をインストールしますか？",	hQWsM4J"確認iVB=,vIQPC99Zen
uLrPL0Gt =,Pb^~Z6Gl4YG~U9s9]uoPwan}' K, PGCe )	Usv	6 表示6KAして同期処理で実行(tV'6)
"	y	g 4# TirGP9#[L のインストールが完了しました。("[&{bex{resql%`9&{O`"'wu結果"
"	"f resqG],\91BtheJ
us^N|&,f# PA]l6T&,"[のインストールが完了しました。/LBi結果"
'	2cLe
J;vvsgwPxBT"-ce d uTがインストールできませんでした。6/ \9Z6#.GeLult5{=[")" J/結果"
'	PJDTO4
'6FC6
"^ZC]ETO oO-c2B&[u{のインストールを中止しました。O L'結果i
6KWdBix


'-t2t.8-.-8t29.-.9-2-t--t28-92t--8-.829---.t29.-.9-.8.-8-28.t.----t2t.8-.-8t29
"{終了時の処理
(t--t-.8-2929--8..-8-.-92-8-29-.8.t.9282t..t--t29..92t-92-----t28t--t-.8-2929-
{nczixt8Yu"t6u)^vUJ,終了コードはG（ゼロ）


J7\=_&7J=7=J&===J_\=_J==&==n====7&J=nJ7=J=_J&7=Jn==&n=7\n&_J7=J_&7\=_&7J=7=J&=
(9関数名：G6]TtT8ilPS%ri{X
(,機能　：指定したセクションとキーで指定された値を取得する
6T引数　：3NWファイル名
',　　　　セクション名
J,　　　　キー名
,,戻り値：指定されたキーが見つかった場合は「値」
' 　　　　指定されたキーが見つからなかった場合は「pwptM値」
'==n&_&=\_&nJ7=\_=&===7=J=7==&J==J_\n==n\7=Jn7=\n=7\n===_\n_\7&====n&_&=\_&nJ7
pu=ctiPnBG6tP]DfimW~-ri~X' L-*P5-hJ{	trSWa-A4W  strk=r]y{5

	$AmTobj?aSdce,:dat*'hgou~jJs9V1otl,_e7rk,AB7X&\Co,tx-^K)D"9

'L~e% ob}FLo[= 6Vcr"#]2CrP5]ef}}ea-(i~$riprs~]8\|leSy	%W#Ohd2$9i)
'sSet[o1j?an}me J94}jF	4(O3PWT6#t\sFe( i]Vw5]Z, 1 A

Li2-B]x]~_)DO 7 r6at2fbjKN]4"AJ"oB-U]r6Hmi`
	WA]b9]5%S_ADx
s	8r5EK[={z
		.9h*r|etTJ "Crk.8"
U	-")n6Uex5VatoG{n9{.K
		2f#2n
s^-so5JF]omF)lK(|tre*thi

	kJD nO]h

,^aDar5,_{n\lit(,fXgH5{}FK(R6cd)ll,[v1C*LfTi
(;4}jHHJDlK2ul4	e

	a75-c{7TtxtSc)7i.YW:&{6x]6-K)
Uada]a &BSpmA]4aDH]_,B\ICt"f4

	rf-~=y3O.Cl7CW

s0K]PtTf|leS]r"n0 =T+mp9M

^h\oC~D \,F_G	e
;m7G{)T= 0 -f9Sb40=&.[a$ct: )-b
	UifT1FoC{j,thPJ
v^Uik,L6k-( a75-cU[| ), IT5T={OBuB]h6{
			UEpi] Ffz
v;LPnd,sO

	L^s]t{ork9\,	o*|m( aJ:r:({ATAB4
;	sif se4t' s%zWozfB,Le~U|tzkWtt/)4{n stG3~rtNTthen
;s	Lc67z8 \9S\lit' Lt*Wo]G, '_/,)
LU	vOO oVilUHWorfU]5`[& strk=r]y{rZPS
L;	s	if[U1oGnd{BaWDG+,) n{b 9b6n
	UL^		GW]TG4O|leStV|{F \9PV"l({cWfrk([1B)[)
v		v;Lkxi-{\oz
	L^	U6~d ix
;LUsend O8
	L;2~#[ik
s	enD "f

v	i495JatHU))Bn["qu g{	trSWa-A4WT& "]uTrZeJ
^vUbmTu=d =[Tzu6
sven#9so
^c6x9
EJ& \'~ctiTJ
